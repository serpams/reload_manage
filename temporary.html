<!DOCTYPE html>
<html>

<head>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        .toggle {
            cursor: pointer;
            user-select: none;
            padding-left: 10px;
        }

        .green-bg {
            background-color: lightgreen;
        }
         /* Estilos CSS existentes aqui... */
         .highlight {
            background-color: pink;
        }
    </style>
</head>


<body>
    <input type="text" id="searchInput" placeholder="Pesquisar por Item ou Serviço">
    <button onclick="searchItem()">Buscar</button>
    <input type="text" id="searchServiceInput" placeholder="Pesquisar por Serviço">
    <button onclick="searchService()">Buscar por Serviço</button>
    <div id="tree-table-container"></div>
    <table>
        <thead>
            <tr>
                <th>Item</th>
            </tr>
        </thead>
        <tbody id="tree-table">
        </tbody>
    </table>
</body>


<script>
    // Defina a sequência de itens
    const items = [
    {
        "id": 598122,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8",
        "servico": "INSTALAÇÕES",
        "percentual": "0.72",
        "valoresEmReais": "228244.66",
        "executado": "",
        "medivel": "",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },

    {
        "id": 598122,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7",
        "servico": "INSTALAÇÕES DE GÁS",
        "percentual": "0.72",
        "valoresEmReais": "228244.66",
        "executado": "",
        "medivel": "",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598123,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.1",
        "servico": "CENTRAL",
        "percentual": "0.03",
        "valoresEmReais": "8115.34",
        "executado": "",
        "medivel": "",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598124,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.1.1",
        "servico": "INSTALAÇÃO  DE  TUBOS  E  CONEXÕES,  EM  AÇO/FERRO  GALVANIZADO,  PARA  O  CENTRO  DE MEDIÇÃO DE GÁS COM CAPACIDADE PARA 10 BOTIJÕES P190 - FORNECIMENTO E INSTALAÇÃO.",
        "percentual": "0.03",
        "valoresEmReais": "8115.34",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598125,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.2",
        "servico": "ALIMENTADOR GERAL",
        "percentual": "0.01",
        "valoresEmReais": "2666.78",
        "executado": "",
        "medivel": "",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598126,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.2.1",
        "servico": "TUBO DE ALUMÍNIO MULTICAMADAS Ø32MM",
        "percentual": "0.01",
        "valoresEmReais": "1928.63",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598127,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.2.2",
        "servico": "JOELHO 90 32MM PARA TUBO MULTICAMADA GÁS",
        "percentual": "0.00",
        "valoresEmReais": "379.65",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598128,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.2.3",
        "servico": "TÊ 90 32 MM PARA TUBO MULTICAMADA GÁS",
        "percentual": "0.00",
        "valoresEmReais": "358.5",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598129,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3",
        "servico": "PRUMADAS E VENTILAÇÃO",
        "percentual": "0.17",
        "valoresEmReais": "55535.24",
        "executado": "",
        "medivel": "",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598130,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.1",
        "servico": "TÉRREO",
        "percentual": "0.01",
        "valoresEmReais": "3382.01",
        "executado": "",
        "medivel": "",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598131,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.1.1",
        "servico": "TUBO DE ALUMÍNIO MULTICAMADAS Ø32MM",
        "percentual": "0.00",
        "valoresEmReais": "271.13",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598132,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.1.2",
        "servico": "TÊ 90 32 MM PARA TUBO MULTICAMADA GÁS",
        "percentual": "0.00",
        "valoresEmReais": "239",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598133,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.1.3",
        "servico": "TUBO AÇO GALVANIZADO DN100MM (4\")",
        "percentual": "0.01",
        "valoresEmReais": "2259.88",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598134,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.1.4",
        "servico": "COTOVELO AÇO GALVANIZADO DN100 (4\")",
        "percentual": "0.00",
        "valoresEmReais": "612",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598135,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.2",
        "servico": "2° PAV (DESVIO)",
        "percentual": "0.03",
        "valoresEmReais": "9874.62",
        "executado": "",
        "medivel": "",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598136,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.2.1",
        "servico": "TUBO DE ALUMÍNIO MULTICAMADAS Ø32MM",
        "percentual": "0.00",
        "valoresEmReais": "775.39",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598137,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.2.2",
        "servico": "TUBO AÇO GALVANIZADO DN100MM (4\")",
        "percentual": "0.02",
        "valoresEmReais": "5552.33",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598138,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.2.3",
        "servico": "JOELHO 90 32MM PARA TUBO MULTICAMADA GÁS",
        "percentual": "0.00",
        "valoresEmReais": "759.3",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598139,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.2.4",
        "servico": "COTOVELO AÇO GALVANIZADO DN100 (4\")",
        "percentual": "0.00",
        "valoresEmReais": "1224",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598140,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.2.5",
        "servico": "TÊ AÇO GALVANIZADO DN100 (4\")",
        "percentual": "0.00",
        "valoresEmReais": "902.56",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598141,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.2.6",
        "servico": "CURVA 45 AÇO GALVANIZADO DN100 (4\")",
        "percentual": "0.00",
        "valoresEmReais": "661.04",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598142,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.3",
        "servico": "PAVIMENTO TIPO x7",
        "percentual": "0.11",
        "valoresEmReais": "34045.94",
        "executado": "",
        "medivel": "",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598143,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.3.1",
        "servico": "TUBO DE ALUMÍNIO MULTICAMADAS Ø32MM",
        "percentual": "0.01",
        "valoresEmReais": "1626.81",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598144,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.3.2",
        "servico": "TÊ 90 32 MM PARA TUBO MULTICAMADA GÁS",
        "percentual": "0.01",
        "valoresEmReais": "2868",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598145,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.3.3",
        "servico": "TUBO AÇO GALVANIZADO DN100MM (4\")",
        "percentual": "0.02",
        "valoresEmReais": "7660.73",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598146,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.3.4",
        "servico": "TÊ Y AÇO GALVANIZADO DN100 (4\")",
        "percentual": "0.04",
        "valoresEmReais": "12635.84",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598147,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.3.5",
        "servico": "CURVA 45 AÇO GALVANIZADO DN100 (4\")",
        "percentual": "0.03",
        "valoresEmReais": "9254.56",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598148,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.4",
        "servico": "ÁTICO E COBERTURA",
        "percentual": "0.03",
        "valoresEmReais": "8232.67",
        "executado": "",
        "medivel": "",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598149,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.4.1",
        "servico": "TUBO AÇO GALVANIZADO DN100MM (4\")",
        "percentual": "0.02",
        "valoresEmReais": "4866.02",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598150,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.4.2",
        "servico": "TUBO DE ALUMÍNIO MULTICAMADAS Ø26MM",
        "percentual": "0.00",
        "valoresEmReais": "326.86",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598151,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.4.3",
        "servico": "UNIÃO DE REDUÇÃO 32X26MM PARA TUBO MULTICAMADA GÁS",
        "percentual": "0.00",
        "valoresEmReais": "140.43",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    },
    {
        "id": 598152,
        "IdObra": "4",
        "IdMes": "70",
        "Mes": "01-12-2022",
        "item": "8.7.3.4.4",
        "servico": "JOELHO 90 26MM PARA TUBO MULTICAMADA GÁS",
        "percentual": "0.00",
        "valoresEmReais": "323.12",
        "executado": "",
        "medivel": "1",
        "MedicaoAnterior": "",
        "Contratado": "",
        "MedicaoContratado": "",
        "MedicaoContratadoPrevisto": "",
        "MedicaoContratadoStatus": "",
        "MedicaoContratadoFechado": "",
        "Cliente": "",
        "MedicaoCliente": "",
        "MedicaoClientePrevisto": "",
        "MedicaoClienteStatus": "",
        "MedicaoClienteFechado": "",
        "created": "",
        "modified": "",
        "remember_token": null,
        "created_at": null,
        "updated_at": null,
        "ValorMedicaoCliente": 0.0,
        "ValorMedicaoContratado": "0",
        "TotalMedicoes": 0.0
    }];

    let indexOfInputs = [];

    // Função para construir a tabela HTML colapsável de forma recursiva com três colunas (Item, Serviço e Percentual)
    function buildCollapsibleTable(tree, parentTable, path = [], isCollapsed = true) {
        const table = document.createElement('table');
        const thead = document.createElement('thead');
        const tbody = document.createElement('tbody');

        // Crie a linha de cabeçalho com três colunas
        const headerRow = document.createElement('tr');
        const headerItem = document.createElement('th');
        headerItem.textContent = 'Item';
        const headerServico = document.createElement('th');
        headerServico.textContent = 'Serviço';
        const headerPercentual = document.createElement('th');
        headerPercentual.textContent = 'Percentual';

        headerRow.appendChild(headerItem);
        headerRow.appendChild(headerServico);
        headerRow.appendChild(headerPercentual);
        thead.appendChild(headerRow);
        table.appendChild(thead);

        for (const key in tree) {
            const row = document.createElement('tr');
            const cellItem = document.createElement('td');
            const cellServico = document.createElement('td');
            const cellPercentual = document.createElement('td');
            const cellInput = document.createElement('td');
            const input = document.createElement('input');
            input.setAttribute('type', 'text');


            const toggle = document.createElement('span');

            toggle.classList.add('toggle');
            if (Object.keys(tree[key]).length > 0) {
                toggle.textContent = isCollapsed ? '►' : '▼';
            }
            cellItem.appendChild(toggle);
            const fullPath = [...path, key].join('.');
            cellItem.appendChild(document.createTextNode(fullPath));
            input.setAttribute('id' , fullPath);
            // add function on key 'enter' press go next input where is in indexofinputs
            input.addEventListener('keyup', function(e){
                if(e.keyCode === 13){
                    let index = indexOfInputs.indexOf(fullPath);
                    if(index < indexOfInputs.length - 1){
                        document.getElementById(indexOfInputs[index + 1]).focus();
                    }
                }
                // if key 'up' press go previous input where is in indexofinputs
                if(e.keyCode === 38){
                    let index = indexOfInputs.indexOf(fullPath);
                    if(index > 0){
                        document.getElementById(indexOfInputs[index - 1]).focus();
                    }
                }
                // if key 'down' press go next input where is in indexofinputs
                if(e.keyCode === 40){
                    let index = indexOfInputs.indexOf(fullPath);
                    if(index < indexOfInputs.length - 1){
                        document.getElementById(indexOfInputs[index + 1]).focus();
                    }
                }
            })
            cellInput.appendChild(input);

            let indexArray = items.findIndex(item => item.item === fullPath)
            cellServico.textContent = items[indexArray].servico || ''; // Adiciona o valor do serviço
            cellPercentual.textContent = items[indexArray].percentual || ''; // Adiciona o valor do percentual

            row.appendChild(cellItem);
            row.appendChild(cellServico);
            row.appendChild(cellPercentual);

            tbody.appendChild(row);

            const subTree = tree[key];
            if (Object.keys(subTree).length > 0) {
                const subTable = buildCollapsibleTable(subTree, table, [...path, key], isCollapsed);
                subTable.style.display = isCollapsed ? 'none' : 'table';
                toggle.textContent = isCollapsed ? '►' : '▼';

                toggle.addEventListener('click', () => {
                    if (subTable.style.display === 'none') {
                        subTable.style.display = 'table';
                        toggle.textContent = '▼';
                    } else {
                        subTable.style.display = 'none';
                        toggle.textContent = '►';
                    }
                });

                // Criar uma nova linha para cada filho
                const newRow = document.createElement('tr');
                // essa linha de filho devera ter o  colspan do pai


                const newCell = document.createElement('td');
                newCell.setAttribute('colspan', '3');
                newCell.appendChild(subTable);
                newRow.appendChild(newCell);
                tbody.appendChild(newRow);
            } else {
                // Se não tiver filhos, definir o fundo verde claro
                indexOfInputs.push(fullPath);
                row.appendChild(cellInput);
                row.classList.add('green-bg');
            }
        }

        table.appendChild(tbody);
        parentTable.appendChild(table);

        return table;
    }
// Função para buscar itens na árvore

function buildTree(items) {
        const tree = {};

        for (const item of items) {
            const parts = item.item.split('.');
            let currentNode = tree;

            for (const part of parts) {
                if (!currentNode[part]) {
                    currentNode[part] = {};
                }
                currentNode = currentNode[part];
            }
        }

        return tree;
    }

const tree = buildTree(items);
    const treeTable = document.getElementById('tree-table');
    buildCollapsibleTable(tree, treeTable, [], false); // Passamos "false" para inicialmente mostrar a tabela aberta
    function searchItem() {
        const searchTerm = document.getElementById('searchInput').value.toLowerCase();
        const treeTable = document.getElementById('tree-table');

        // Remova destaques anteriores
        const highlightedItems = document.querySelectorAll('.highlight');
        highlightedItems.forEach(item => {
            item.classList.remove('highlight');
        });

        // Realize a pesquisa em todos os itens
        const allItems = treeTable.querySelectorAll('td:first-child');
        let found = false;

        allItems.forEach(item => {
            const itemText = item.textContent.toLowerCase();
            if (itemText.includes(searchTerm)) {
                // Encontrei um item correspondente, destaque-o e role até ele
                item.classList.add('highlight');
                item.scrollIntoView({ behavior: 'smooth' });
                found = true;
            }
        });

        if (!found) {
            // Item não encontrado, exiba uma mensagem ou realize outra ação apropriada
            alert('Item não encontrado.');
        }
    }
    function searchService() {
        const searchServiceTerm = document.getElementById('searchServiceInput').value.toLowerCase();
        const treeTable = document.getElementById('tree-table');

        // Remova destaques anteriores
        const highlightedItems = document.querySelectorAll('.highlight');
        highlightedItems.forEach(item => {
            item.classList.remove('highlight');
        });

        // Realize a pesquisa em todos os serviços
        const allServices = treeTable.querySelectorAll('td:nth-child(2)');
        let found = false;

        allServices.forEach(service => {
            const serviceText = service.textContent.toLowerCase();
            if (serviceText.includes(searchServiceTerm)) {
                // Encontrei um serviço correspondente, destaque-o e role até ele
                service.closest('tr').querySelector('td:first-child').classList.add('highlight');
                service.scrollIntoView({ behavior: 'smooth' });
                found = true;
            }
        });

        if (!found) {
            // Serviço não encontrado, exiba uma mensagem ou realize outra ação apropriada
            alert('Serviço não encontrado.');
        }
    }
</script>

</html>
